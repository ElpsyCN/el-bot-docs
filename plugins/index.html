<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>使用说明 | El Bot Docs</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/logo.svg">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/logo.png">
    <link rel="mask-icon" href="/logo.png" color="steelblue">
    <meta name="description" content="">
    <meta name="theme-color" content="steelblue">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="steelblue">
    <meta name="msapplication-TileImage" content="/logo.png">
    <meta name="msapplication-TileColor" content="steelblue">
    
    <link rel="preload" href="/assets/css/0.styles.687acee7.css" as="style"><link rel="preload" href="/assets/js/app.022c8811.js" as="script"><link rel="preload" href="/assets/js/2.6cc8bf5f.js" as="script"><link rel="preload" href="/assets/js/23.17d9d8b1.js" as="script"><link rel="preload" href="/assets/js/5.a4aeb15b.js" as="script"><link rel="preload" href="/assets/js/3.42610edc.js" as="script"><link rel="preload" href="/assets/js/4.7611c16d.js" as="script"><link rel="preload" href="/assets/js/6.98d4e3b0.js" as="script"><link rel="prefetch" href="/assets/js/10.d3a1fab5.js"><link rel="prefetch" href="/assets/js/11.0b7a9fd1.js"><link rel="prefetch" href="/assets/js/12.1840dc0a.js"><link rel="prefetch" href="/assets/js/13.712c39d0.js"><link rel="prefetch" href="/assets/js/14.95544350.js"><link rel="prefetch" href="/assets/js/15.6ce8214a.js"><link rel="prefetch" href="/assets/js/16.13239339.js"><link rel="prefetch" href="/assets/js/17.57ca02b6.js"><link rel="prefetch" href="/assets/js/18.46708237.js"><link rel="prefetch" href="/assets/js/19.507df81e.js"><link rel="prefetch" href="/assets/js/20.5069d77f.js"><link rel="prefetch" href="/assets/js/21.40018c3a.js"><link rel="prefetch" href="/assets/js/22.ac3eb90e.js"><link rel="prefetch" href="/assets/js/24.b8e2af90.js"><link rel="prefetch" href="/assets/js/25.fb1b9696.js"><link rel="prefetch" href="/assets/js/7.5e66a90e.js"><link rel="prefetch" href="/assets/js/8.c4f6f6de.js"><link rel="prefetch" href="/assets/js/9.fce4c4d2.js">
    <link rel="stylesheet" href="/assets/css/0.styles.687acee7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="El Bot Docs" class="logo"> <span class="site-name can-hide">El Bot Docs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/" class="nav-link">
  指南
</a></div><div class="nav-item"><a href="/api/" class="nav-link">
  API
</a></div><div class="nav-item"><a href="/plugins/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  插件
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Ecosystem" class="dropdown-title"><span class="title">生态</span> <span class="arrow down"></span></button> <button type="button" aria-label="Ecosystem" class="mobile-dropdown-title"><span class="title">生态</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/YunYouJun/el-bot/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  el-bot
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/ElpsyCN/el-bot-api/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  el-bot-api
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/ElpsyCN/el-bot-plugins/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  el-bot-plugins
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/ElpsyCN/el-bot-template/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  el-bot-template
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://bot.elpsy.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  el-bot-web
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/YunYouJun/el-bot" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/" class="nav-link">
  指南
</a></div><div class="nav-item"><a href="/api/" class="nav-link">
  API
</a></div><div class="nav-item"><a href="/plugins/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  插件
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Ecosystem" class="dropdown-title"><span class="title">生态</span> <span class="arrow down"></span></button> <button type="button" aria-label="Ecosystem" class="mobile-dropdown-title"><span class="title">生态</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/YunYouJun/el-bot/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  el-bot
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/ElpsyCN/el-bot-api/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  el-bot-api
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/ElpsyCN/el-bot-plugins/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  el-bot-plugins
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/ElpsyCN/el-bot-template/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  el-bot-template
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://bot.elpsy.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  el-bot-web
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/YunYouJun/el-bot" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/plugins/" aria-current="page" class="active sidebar-link">使用说明</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/plugins/#插件列表" class="sidebar-link">插件列表</a></li><li class="sidebar-sub-header"><a href="/plugins/#如何编写" class="sidebar-link">如何编写</a></li><li class="sidebar-sub-header"><a href="/plugins/#加载插件" class="sidebar-link">加载插件</a></li></ul></li><li><a href="/plugins/default.html" class="sidebar-link">默认插件</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="使用说明"><a href="#使用说明" class="header-anchor">#</a> 使用说明</h1> <p>el-bot 使用了 <a href="https://github.com/YunYouJun/mirai-ts" target="_blank" rel="noopener noreferrer">mirai-ts<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p>因此你在编写插件时，可以通过 <code>ctx.mirai.api</code> 的方式直接使用 mirai-ts 的 API 进行编写，同时不需要处理登录、加载插件等问题。</p> <p>mirai-ts 也提供了许多字符匹配、彩色日志等辅助小工具。</p> <blockquote><p><a href="https://github.com/project-mirai/mirai-api-http/blob/master/EventType.md" target="_blank" rel="noopener noreferrer">Mirai-api-http 事件类型一览<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <a href="https://github.com/project-mirai/mirai-api-http/blob/master/MessageType.md" target="_blank" rel="noopener noreferrer">Mirai-api-http 消息类型一览<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p>具体例子见下方。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>如果你觉得某个功能非常有用受众很广，可以考虑直接为 <a href="https://github.com/ElpsyCN/el-bot" target="_blank" rel="noopener noreferrer">el-bot<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 提 PR。</p> <p>我们也建立了一个仓库 <a href="https://github.com/ElpsyCN/el-bot-plugins" target="_blank" rel="noopener noreferrer">el-bot-plugins<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 专门收集有趣的插件（对部分群体有用但不是必须的）。</p></div> <p>插件主要分这几种类型：</p> <ul><li><code>default</code>: 内置插件 <code>../plugins/rss</code></li> <li><code>official</code>: 官方插件 <code>@el-bot/plugin-niubi</code></li> <li><code>community</code>: 社区插件 <code>el-bot-plugin-xxx</code>（如果您放在个人仓库中并自行发布为 npm 包，请遵循该命名规范）</li> <li><code>custom</code>: 自定义插件 <code>./xxx/xxx</code></li></ul> <h2 id="插件列表"><a href="#插件列表" class="header-anchor">#</a> 插件列表</h2> <div class="chat-panel"><div class="controls"><div class="circle red"></div> <div class="circle yellow"></div> <div class="circle green"></div> <div class="title">聊天记录</div></div> <div class="content"><div class="chat-message"><div style="display:inline-block;"><img src="https://q1.qlogo.cn/g?b=qq&amp;nk=910426929&amp;s=100" class="avatar"></div> <div class="message-box"><div class="nickname">云游君</div> <div class="message">el plugins</div></div></div> <div class="chat-message"><div style="display:inline-block;"><img src="https://q1.qlogo.cn/g?b=qq&amp;nk=712727945&amp;s=100" class="avatar"></div> <div class="message-box"><div class="nickname">小云</div> <div class="message">默认插件:<br>- answer@0.1.0: 自动应答<br>- blacklist@0.0.1: 黑名单<br>- forward@0.0.2: 消息转发<br>- limit@0.1.0: 限制消息频率<br>- memo@0.0.1: 备忘录<br>- nbnhhsh@0.0.2: 能不能好好说话？<br>- qrcode@0.0.2: 二维码生成器<br>- rss@0.0.2: 订阅 RSS 信息<br>- report@0.0.1: 消息报告<br>- search@0.0.5: 引擎搜索<br>- search-image@0.1.0: 以图搜图<br>- teach@0.1.0: 问答学习（教小云做事）<br>- workflow@0.0.1: 工作流 <br>官方插件:<br>- niubi@0.1.2: 夸人牛逼<br>- setu@0.0.12: 发点色图 <br>无社区插件<br>自定义插件:<br>- ./bot/plugins/test@未知: 未知<br>- ./bot/plugins/cbd@0.0.1: 老师来了吗？
  </div></div></div></div></div> <h2 id="如何编写"><a href="#如何编写" class="header-anchor">#</a> 如何编写</h2> <p>我将示范如何新建一个名为 <code>test</code> 的自定义插件。</p> <blockquote><p>你也可以使用 typescript 编写你的插件。</p></blockquote> <p>新建 <code>plugins/custom</code> 文件夹（其实你也可以随便放，路径写对就行），新建 <code>test.js</code> 文件。</p> <blockquote><p><strong>你的文件名将是你的插件名。</strong></p></blockquote> <p>或者新建 <code>/plugins/custom/test</code> 文件夹，新建 <code>index.js</code> 文件。（推荐，方便管理单个含有较多内容的插件）</p> <p>默认传入机器人上下文 ctx。</p> <ul><li>ctx 是机器人的实例本身</li> <li>通过 <code>ctx.el.config</code> 获取机器人相关的配置（即你写在配置文件中的配置）</li> <li>通过 <code>ctx.mirai</code> 获取 mirai 实例（即 mirai-ts 的实例）</li></ul> <p>插件默认导出一个函数，你无需操心它的加载问题，只需后续在配置文件中写上该插件的名字，将会自动加载。</p> <blockquote><p><a href="https://developer.mozilla.org/zh-CN/docs/learn/JavaScript/%E5%BC%82%E6%AD%A5/Async_await" target="_blank" rel="noopener noreferrer">async 和 await:让异步编程更简单<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p>test.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 使用 JSDoc 可以获取 el-bot 及 mirai-ts 的代码提示</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">default</span><span class="token operator">:</span> Bot <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;el-bot&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 这里因为后续用到了异步编程关键字 await，如果你用不着，此处无需添加 async 关键字。
 * 而应该使用
 * module.exports = function(ctx) {
 * @param {Bot} ctx
 */</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> mirai <span class="token operator">=</span> ctx<span class="token punctuation">.</span>mirai<span class="token punctuation">;</span>

  <span class="token comment">// 对收到的消息进行处理</span>
  <span class="token comment">// message 本质相当于同时绑定了 FriendMessage GroupMessage TempMessage</span>
  <span class="token comment">// 你也可以单独对某一类消息进行监听</span>
  mirai<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;on message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 调用 mirai-ts 封装的 mirai-api-http 发送指令</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;send command help&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> mirai<span class="token punctuation">.</span>api<span class="token punctuation">.</span>command<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;help&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;帮助信息:&quot;</span> <span class="token operator">+</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 处理各种事件类型</span>
  <span class="token comment">// 事件订阅说明（名称均与 mirai-api-http 中时间名一致）</span>
  <span class="token comment">// https://github.com/RedBeanN/node-mirai/blob/master/event.md</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;on other event&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// https://github.com/project-mirai/mirai-api-http/blob/master/EventType.md#群消息撤回</span>
  mirai<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;GroupRecallEvent&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> operator <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>operator<span class="token punctuation">.</span>memberName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> 撤回了一条消息，并拜托你不要再发色图了。</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
    mirai<span class="token punctuation">.</span>api<span class="token punctuation">.</span><span class="token function">sendGroupMessage</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> operator<span class="token punctuation">.</span>group<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>test.ts</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> mirai <span class="token operator">=</span> ctx<span class="token punctuation">.</span>mirai<span class="token punctuation">;</span>
  mirai<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;on message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="辅助函数"><a href="#辅助函数" class="header-anchor">#</a> 辅助函数</h3> <ul><li><code>isListening(sender, listen)</code>: 传入 <a href="https://docs.bot.elpsy.cn/config.html#%E7%9B%91%E5%90%AC%E4%B8%8E%E7%9B%AE%E6%A0%87" target="_blank" rel="noopener noreferrer">配置讲解<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 处 <code>listen</code> 的格式，可以快速判断是否在监听。</li> <li><code>sendMessageByConfig(messageChain, target)</code>: 传入 配置讲解处 <code>target</code> 的格式，可以快速发送给多个指定对象。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> canForward <span class="token operator">=</span> ctx<span class="token punctuation">.</span>status<span class="token punctuation">.</span><span class="token function">isListening</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">,</span> item<span class="token punctuation">.</span>listen<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>canForward<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span>sender<span class="token punctuation">.</span><span class="token function">sendMessageByConfig</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>messageChain<span class="token punctuation">,</span> item<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="插件信息"><a href="#插件信息" class="header-anchor">#</a> 插件信息</h3> <blockquote><p>标准的插件格式请参照 <a href="https://github.com/ElpsyCN/el-bot-plugins" target="_blank" rel="noopener noreferrer">el-bot-plugins<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 说明。（如果你只是自行使用，大可无视。）</p></blockquote> <p>如果你想将插件提交到 <a href="https://github.com/ElpsyCN/el-bot-plugins" target="_blank" rel="noopener noreferrer">官方插件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 中，<code>package.json</code> 与 <code>README.md</code> 是必不可少的。
这更方便别人知道如何使用它。</p> <h4 id="package-json"><a href="#package-json" class="header-anchor">#</a> package.json</h4> <p><code>el-bot.db</code> 设置为 <code>true</code>，代表需要依赖数据库。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;blacklist&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;private&quot;</span><span class="token operator">:</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.0.1&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;黑名单&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;el-bot&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;db&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">&quot;author&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;YunYouJun&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://www.yunyoujun.cn&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;me@yunyoujun.cn&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="加载插件"><a href="#加载插件" class="header-anchor">#</a> 加载插件</h2> <h3 id="通过配置加载"><a href="#通过配置加载" class="header-anchor">#</a> 通过配置加载</h3> <p>编写完，你还需要在你的自定义配置文件 <code>el/index.yml</code> 中加载它。</p> <blockquote><p>记得重启。</p></blockquote> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">plugins</span><span class="token punctuation">:</span>
  <span class="token comment"># default:</span>
  <span class="token comment">#   - answer</span>
  <span class="token comment">#   - cli</span>
  <span class="token comment">#   - forward</span>
  <span class="token comment">#   - rss</span>
  <span class="token key atrule">custom</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> test
</code></pre></div><p>mirai-ts 实现了一个事件队列，对应的监听事件将会推入对应事件的列表，并在收到对应类型的消息时执行。</p> <p>自定义插件将会在默认插件之后进入事件队列，</p> <p>任何插件的加载顺序取决于你的配置顺序。</p> <h3 id="自行加载"><a href="#自行加载" class="header-anchor">#</a> 自行加载</h3> <p>你也可以在你的代码中自行加载它，此时它将不会出现在插件列表中。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Bot <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;el-bot&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> bot <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>yourPlugin<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// yourPlugin 应当是一个默认导出的函数或带有 &quot;install&quot; 属性的对象</span>
</code></pre></div><p>如果你希望它出现在插件列表中，你可以使用 <code>bot.plugin(name: string, plugin: Plugin, ...options: any[])</code> 来注册它。</p> <div class="language-js extra-class"><pre class="language-js"><code>bot<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token string">&quot;奇怪的插件&quot;</span><span class="token punctuation">,</span> fn<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="默认插件"><a href="#默认插件" class="header-anchor">#</a> 默认插件</h3> <p>即随 el-bot 默认加载的插件列表。</p> <p>你可以覆盖 <code>plugins.default</code> 来只加载你想加载的默认插件。</p> <h3 id="官方插件"><a href="#官方插件" class="header-anchor">#</a> 官方插件</h3> <p><a href="https://github.com/ElpsyCN/el-bot-plugins" target="_blank" rel="noopener noreferrer">el-bot-plugins<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 是 el-bot 的官方插件集中地，它提供了许多有趣的插件。</p> <p>该部分插件将由我们进行审核，并统一发布至 npm 中 <code>@el-bot</code> 的命名空间下。（如：<code>@el-bot/plugin-niubi</code>）</p> <p>插件的使用方式，见各插件的 <code>README.md</code>。</p> <p>同时也欢迎你为其提交插件，来给更多人使用。</p> <p>譬如加载 <code>niubi</code> 插件：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> @el-bot/plugin-niubi
<span class="token comment"># yarn add @el-bot/plugin-niubi</span>
</code></pre></div><div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">plugins</span><span class="token punctuation">:</span>
  <span class="token key atrule">official</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> niubi
</code></pre></div><h3 id="社区插件"><a href="#社区插件" class="header-anchor">#</a> 社区插件</h3> <p>社区插件即您自行编写并发布的插件。</p> <p>如果您希望被更多人检索到，请遵循 <code>el-bot-plugin-xxx</code> 的命名规范。</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> el-bot-plugin-xxx
</code></pre></div><h3 id="自定义插件"><a href="#自定义插件" class="header-anchor">#</a> 自定义插件</h3> <p>自定义插件即您自行编写，且暂不打算发布的插件。</p> <p>引入方式是您相对主目录的相对路径。</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">plugins</span><span class="token punctuation">:</span>
  <span class="token key atrule">custom</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> ./xxx/yyy
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/YunYouJun/el-bot/edit/master/docs/plugins/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/plugins/default.html">
        默认插件
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.022c8811.js" defer></script><script src="/assets/js/2.6cc8bf5f.js" defer></script><script src="/assets/js/23.17d9d8b1.js" defer></script><script src="/assets/js/5.a4aeb15b.js" defer></script><script src="/assets/js/3.42610edc.js" defer></script><script src="/assets/js/4.7611c16d.js" defer></script><script src="/assets/js/6.98d4e3b0.js" defer></script>
  </body>
</html>
